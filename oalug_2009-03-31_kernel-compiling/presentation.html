<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.6: http://docutils.sourceforge.net/" />
<meta name="version" content="S5 1.1" />
<title>Ogden Area Linux User Group</title>
<meta name="date" content="2009-03-31" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5631 2008-08-24 13:01:23Z goodger $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<script src="ui/small-black/slides.js" type="text/javascript"></script>
<link rel="stylesheet" href="ui/small-black/slides.css"
      type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/small-black/outline.css"
      type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/small-black/print.css"
      type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/small-black/opera.css"
      type="text/css" media="projection" id="operaFix" />

<style type="text/css">
#currentSlide {display: none;}
</style>
</head>
<body>
<div class="layout">
<div id="controls"></div>
<div id="currentSlide"></div>
<div id="header">

</div>
<div id="footer">
<h1>Ogden Area Linux User Group</h1>
<h2><a class="reference external" href="http://www.faqs.org/docs/Linux-HOWTO/Kernel-HOWTO.html">http://www.faqs.org/docs/Linux-HOWTO/Kernel-HOWTO.html</a></h2>
</div>
</div>
<div class="presentation">
<div class="slide" id="slide0">
<h1 class="title">Ogden Area Linux User Group</h1>
<h2 class="subtitle" id="compiling-a-custom-kernel">Compiling a Custom Kernel</h2>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr class="field"><th class="docinfo-name">Presenter:</th><td class="field-body">Seth House</td>
</tr>
<tr><th class="docinfo-name">Date:</th>
<td>2009-03-31</td></tr>
</tbody>
</table>

</div>
<div class="slide" id="what-is-the-linux-kernel">
<h1>What is the Linux kernel?</h1>
<!-- FIXME -->
<p class="handout">The kernel is Linux.</p>
<blockquote class="handout">
<p>In computing, the kernel is the central component of most computer
operating systems. Its responsibilities include managing the system's
resources (the communication between hardware and software
components). As a basic component of an operating system, a kernel
provides the lowest-level abstraction layer for the resources
(especially memory, processors and I/O devices) that application
software must control to perform its function.</p>
<p class="attribution">&mdash;<a class="reference external" href="http://en.wikipedia.org/wiki/Kernel_(computer_science">http://en.wikipedia.org/wiki/Kernel_(computer_science</a>)</p>
</blockquote>
</div>
<div class="slide" id="why-compile-it-yourself">
<h1>Why Compile it Yourself?</h1>
<p class="handout">Chances are you don't need to compile your own kernel.</p>
<p class="handout">Compiling some drivers (e.g. ATI or Nvidia graphics drivers, VirtualBox or
VMware kernel modules) require kernel headers to be installed. If you only
need the headers, you don’t need to compile your own kernel. If your kernel
headers aren’t installed, consult your distro’s documentation.</p>
<blockquote class="handout">
<p>Kernel headers are C header files which provide some definitions of the
low-level kernel ABI, to be shared between the kernel and userspace
programs. Most userspace programs should not include kernel headers;
they are only intended to be used directly by system libraries and
low-level tools and daemons.</p>
<p>The <tt class="docutils literal"><span class="pre">make</span> <span class="pre">headers_install</span></tt> command, when executed in the kernel's
source tree, exports the kernel's header files in a form suitable for
use by userspace programs.</p>
<p>When exported, most kernel headers reside in the <tt class="docutils literal"><span class="pre">/usr/include/asm</span></tt>
and <tt class="docutils literal"><span class="pre">/usr/include/linux</span> <span class="pre">directories</span></tt>.</p>
<p class="attribution">&mdash;<a class="reference external" href="http://en.wikipedia.org/wiki/Kernel_header#Kernel_headers">http://en.wikipedia.org/wiki/Kernel_header#Kernel_headers</a></p>
</blockquote>
<div class="sidebar">
<p class="first sidebar-title">kernel headers</p>
<p class="last">Kernel headers are sometimes needed to compile certain drivers.</p>
</div>
<ul class="incremental simple">
<li>You want to know how to do it.</li>
<li>You are doing kernel development.</li>
<li>You don’t want to wait for new drivers/features/fixes to make it to your
favorite Linux distribution.</li>
<li>You want to apply a patch, maybe to modify some driver.</li>
<li>You are blind and want TTS to begin right as Linux boots. (<a class="reference external" href="http://www.linux-speakup.org/">Speakup</a>)</li>
<li>You’re trying to wring every last micro-second from your bootup time.</li>
</ul>
</div>
<div class="slide" id="where-do-you-get-it">
<h1>Where Do You Get It?</h1>
<p class="handout">Get it from kernel.org.</p>
<blockquote class="handout">
<p>The old scheme (after 1.0 and prior to version 2.6):</p>
<blockquote>
<ul class="simple">
<li>The A number denotes the kernel version. It is rarely changed,
and only when major changes in the code and the concept of the
kernel occur. It has been changed twice in the history of the
kernel: In 1994 (version 1.0) and in 1996 (version 2.0).</li>
<li>The B number denotes the major revision of the kernel<ul>
<li>The kernel used the traditional even-odd system version
numbering system.</li>
</ul>
</li>
<li>The C number indicates the minor revision of the kernel. This
number was changed when security patches, bug fixes, new features
or drivers were implemented in the kernel.</li>
</ul>
</blockquote>
<p>After the release of 2.6.0 (Dec 2003[34]) it was realized that a much
shorter release cycle would be beneficial. Since then:</p>
<blockquote>
<ul class="simple">
<li>A and B are largely irrelevant</li>
<li>C is the version of the kernel</li>
</ul>
</blockquote>
<p class="attribution">&mdash;<a class="reference external" href="http://en.wikipedia.org/wiki/Kernel_header#Version_numbering">http://en.wikipedia.org/wiki/Kernel_header#Version_numbering</a></p>
</blockquote>
<p><a class="reference external" href="http://kernel.org/">http://kernel.org/</a></p>
<ol class="incremental arabic simple">
<li>Untar the source in <tt class="docutils literal"><span class="pre">/usr/src/</span></tt>.</li>
<li>Symlink the new directory to <tt class="docutils literal"><span class="pre">/usr/src/linux</span></tt>.</li>
</ol>
</div>
<div class="slide" id="quick-overview">
<h1>Quick Overview</h1>
<p class="handout"><tt class="docutils literal"><span class="pre">mrproper</span></tt> refers to the Procter &amp; Gamble product, Mr. Proper, which is
the European (at least Finnish/German/Czech) branding for Mr. Clean <a class="footnote-reference" href="#id2" id="id1">[1]</a>.</p>
<blockquote class="handout">
<p>“…‘make clean’ is simple soap wash, ‘make mrproper’ cleans also tougher
stains by using stronger solvents…”</p>
<p class="attribution">&mdash;<a class="reference external" href="http://lkml.indiana.edu/hypermail/linux/kernel/0101.3/0295.html">http://lkml.indiana.edu/hypermail/linux/kernel/0101.3/0295.html</a></p>
</blockquote>
<table class="handout docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Mr._Clean#Mr._Clean_in_popular_culture">http://en.wikipedia.org/wiki/Mr._Clean#Mr._Clean_in_popular_culture</a></td></tr>
</tbody>
</table>
<ol class="incremental arabic simple">
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">mrproper</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">all</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">modules_install</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cp</span> <span class="pre">./arch/i386/boot/bzimage</span> <span class="pre">/boot/vmlinuz-2.6.27.7</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cp</span> <span class="pre">./.config</span> <span class="pre">/boot/config-2.6.27.7</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cp</span> <span class="pre">./System.map</span> <span class="pre">/boot/System.map-2.6.27.7</span></tt></li>
<li>Make symlinks to the files in <tt class="docutils literal"><span class="pre">/boot</span></tt> as needed.</li>
<li>Configure grub or LILO.</li>
<li>Reboot to test.</li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">clean</span></tt> (optional, to free up disk space)</li>
</ol>
</div>
<div class="slide" id="create-the-config-file">
<h1>Create the Config File</h1>
<p class="handout">Your best bet is to start with a copy of your distro’s kernel config file.
This step is optional, but it will save you a lot of time and give you a
kernel that is most like one that your distro ships.</p>
<p class="handout">The file usually lives in <tt class="docutils literal"><span class="pre">/boot/config</span></tt> (it may be a symlink). Or if you
already have other kernel sources installed look for a hidden file in the
base directory (e.g. <tt class="docutils literal"><span class="pre">/usr/src/linux-2.6.26.6/.config</span></tt>). Or you may have
to hunt it down in your distro’s packages.</p>
<p class="handout">If you’re using a config file for an older kernel version you’ll want to
start by running <tt class="docutils literal"><span class="pre">make</span> <span class="pre">oldconfig</span></tt>. It will ask you a bunch of questions
about things that have changed between kernel versions; generally the
default answer is fine.</p>
<p class="handout">Using the graphical config utility is easiest for users unfamiliar with the
process. The new <tt class="docutils literal"><span class="pre">xconfig</span></tt> option uses the QT libraries, the older
<tt class="docutils literal"><span class="pre">gconfig</span></tt> uses the GTK libraries.</p>
<p class="sidebar">Copy the config <em>after</em> running <tt class="docutils literal"><span class="pre">make</span> <span class="pre">mrproper</span></tt> or it will be deleted.</p>
<ol class="incremental arabic simple">
<li><tt class="docutils literal"><span class="pre">cp</span> <span class="pre">/boot/config</span> <span class="pre">/usr/src/linux/.config</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">oldconfig</span></tt></li>
<li>Tweak any configuration options<ul>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">config</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">menuconfig</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">xconfig</span></tt></li>
<li><tt class="docutils literal"><span class="pre">make</span> <span class="pre">gconfig</span></tt></li>
</ul>
</li>
</ol>
</div>
<div class="slide" id="how-can-you-uninstall-an-old-version">
<h1>How Can You Uninstall an Old Version?</h1>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">-r</span> <span class="pre">/lib/modules/2.6.27.7</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">/boot/vmlinuz-2.6.27.7</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">/boot/config-2.6.27.7</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">/boot/System.map-2.6.27.7</span></tt></li>
</ol>
</div>
<div class="slide" id="patching-an-existing-source-tree">
<h1>Patching an Existing Source Tree</h1>
<p class="handout">Sometimes you already have a kernel source tree on your system and would
rather download a smaller patch than a whole new source tar-ball.</p>
<ol class="incremental arabic simple">
<li><tt class="docutils literal"><span class="pre">cd</span> <span class="pre">/usr/src/linux-2.6.26</span></tt></li>
<li><tt class="docutils literal"><span class="pre">gzip</span> <span class="pre">-dc</span> <span class="pre">patch-2.6.27.gz</span> <span class="pre">|</span> <span class="pre">patch</span> <span class="pre">-p0</span></tt></li>
</ol>
</div>
<div class="slide" id="some-nomenclature">
<h1>Some Nomenclature</h1>
<dl class="docutils">
<dt>vmlinuz</dt>
<dd>The compressed built kernel that has been made bootable.</dd>
<dt>vmlinux</dt>
<dd>The vmlinux is the uncompressed built kernel.</dd>
<dt>bzImage</dt>
<dd>The compressed kernel image created with command <tt class="docutils literal"><span class="pre">make</span> <span class="pre">bzImage</span></tt> during
kernel compile.</dd>
<dt>System.map</dt>
<dd>A “phone directory” list of function in a particular build of a kernel. If
you use the wrong (or no) System.map, debugging crashes is harder (kernel
oopses), but has no other effects.</dd>
</dl>
<!-- vim:filetype=rst -->
</div>
</div>
</body>
</html>
